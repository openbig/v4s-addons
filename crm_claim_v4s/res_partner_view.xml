<?xml version="1.0"?>
<openerp>
    <data>
        <record model="ir.actions.act_window" id="v4s_crm_claim_action">
            <field name="name">Claims</field>
            <field name="res_model">crm.claim</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,calendar,form</field>
            <field name="view_id" ref="crm_claim.crm_case_claims_tree_view"/>
            <field name="context">{"search_default_user_id":False}</field>
            <field name="search_view_id" ref="crm_claim.view_crm_case_claims_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Record and track your customers' claims. Claims may be linked to a sales order or a lot.You can send emails with attachments and keep the full history for a claim (emails sent, intervention type and so on).Claims may automatically be linked to an email address using the mail gateway module.
                </p>
            </field>
        </record>


        <record model="ir.ui.view" id="view_claim_res_partner_info_form_v4s_v4s">
            <field name="name">view_claim_res_partner_info_form_v4s_v4s</field>
            <field name="model">res.partner</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="crm_claim.view_claim_res_partner_info_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@string='Claims']/.." position="replace">
                    <!--<attribute name="name">%(v4s_crm_claim_action)d</attribute>-->
                </xpath>
            </field>
        </record>

        <!-- crm.claim Claim Form View -->
        <record model="ir.ui.view" id="crm_claim_view_partners_tree_v4s">
            <field name="name">res.partner.crm.claim.v4s.inherit2</field>
            <field name="model">res.partner</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="arch" type="xml">

                <xpath expr="//page[@name='sales_purchases']" position="after">
                    <page string="Claims">
                        <field name="claims_ids" colspan="4" nolabel="0" >
                            <tree>
                                <field name="name"/>
                                <field name="date"/>
                                <field name="stage_id"/>
                            </tree>
                        </field>

                        <field name="claims_ids2" colspan="4" nolabel="0" >
                            <tree>
                                <field name="name"/>
                                <field name="date"/>
                                <field name="stage_id"/>
                            </tree>
                        </field>
                    </page>
                </xpath>

                <xpath expr="//div[@name='buttons']" position="inside">
                    <button class="oe_inline oe_stat_button" type="action"
                        context="{'search_default_partner_id2': active_id, 'default_partner_id2': active_id}"
                        name="%(v4s_crm_claim_action)d" icon="fa-comments" groups="base.group_sale_salesman">
                        <field string="Customer Claims" name="claim_count2" widget="statinfo" />
                    </button>

                    <button class="oe_inline oe_stat_button" type="action"
                        context="{'search_default_partner_id': active_id, 'default_partner_id': active_id}"
                        name="%(v4s_crm_claim_action)d" icon="fa-comments" groups="base.group_sale_salesman">
                        <field string="Supplier Claims" name="claim_count" widget="statinfo"/>
                    </button>
                </xpath>

            </field>
        </record>


        <record model="ir.ui.view" id="view_crm_case_claims_filter_v4s">
            <field name="name">CRM - Claims Search v4s</field>
            <field name="model">crm.claim</field>
            <field name="type">form</field>
            <field name="inherit_id" ref="crm_claim.view_crm_case_claims_filter"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="partner_id2" filter_domain="[('partner_id2','child_of',self)]"/>
                </field>
            </field>
        </record>






    </data>
</openerp>
